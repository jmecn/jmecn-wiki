<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.4"><meta name="author" content="(翻译 jmecn)"><meta name="keywords" content="beginner, rootNode, node, intro, documentation, color, spatial, geometry, scenegraph, mesh"><title>jMonkeyEngine 3 教程 (2) - 节点</title><link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"></head><body class="article toc2 toc-left"><div id="header"><div id="toolbar"><a href="https://github.com/jmecn/wiki/edit/master/src/docs/asciidoc/beginner/hello_node.adoc"><i class="fa fa-pencil-square" aria-hidden="true"></i></a><a href="https://github.com/jmecn/wiki/new/master/src/docs/asciidoc/beginner/"><i class="fa fa-plus-square" aria-hidden="true"></i></a><input dir="auto" style="position: relative; vertical-align: top;" spellcheck="false" autocomplete="off" class="searchbox__input aa-input" id="doc-search" name="search" placeholder="Search in the doc" required="required" type="search"></div><h1>jMonkeyEngine 3 教程 (2) - 节点</h1><div class="details"><span class="author" id="author">(翻译 jmecn)</span><br><span id="revnumber">version ,</span> <span id="revdate">2018/01/22 16:47</span></div><div id="toc" class="toc2"><div id="toctitle">Table of Contents</div><ul class="sectlevel1"><li><a href="#示例">示例</a></li><li><a href="#理解术语">理解术语</a></li><li><a href="#了解代码">了解代码</a><ul class="sectlevel2"><li><a href="#什么是-pivot-节点">什么是 “Pivot” 节点?</a></li></ul></li><li><a href="#如何布置场景">如何布置场景?</a></li><li><a href="#如何变换空间体">如何变换空间体</a></li><li><a href="#我应该如何故障排除空间体">我应该如何故障排除空间体？</a></li><li><a href="#如何添加自定义数据到空间体">如何添加自定义数据到空间体？</a></li><li><a href="#结语">结语</a></li></ul></div></div><div id="content"><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>上一篇: <a href="../beginner/hello_simpleapplication.html">SimpleApplication</a>,
下一篇: <a href="../beginner/hello_asset.html">加载资产</a>.</p></div>
<div class="paragraph"><p>在这个教程，我们来学习3d场景的创建。</p></div>
<div class="ulist"><ul><li><p>这个教程假设你了解 <a href="../jme3/the_scene_graph.html">场景图</a> 。</p></li><li><p>或者查看 <a href="../jme3/scenegraph_for_dummies.html">给初学者的场景图</a> 。</p></li></ul></div>
<div class="paragraph"><p>在创建一个3d游戏</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>要创景一些场景个体，比如玩家，建筑等。</p></li><li><p>要把这些个体添加到场景</p></li><li><p>要给予这些个体：移动，旋转，缩放，上色和动画</p></li></ol></div>
<div class="paragraph"><p>在这里你会学到：场景是如何表达一个3d世界, rooNode的重要性。你会学到：如何创建简单的个体，如何让它们携带自定义数据（比如血量）和如何“变换”它们（移动，旋转，缩放）。你会学到两个空间物体的不同：Nodes（节点）和Geometries（几何体）。</p></div></div></div>
<div class="sect1"><h2 id="示例">示例</h2><div class="sectionbody"><div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jme3test.helloworld</span>;

<span class="keyword">import</span> <span class="include">com.jme3.app.SimpleApplication</span>;
<span class="keyword">import</span> <span class="include">com.jme3.material.Material</span>;
<span class="keyword">import</span> <span class="include">com.jme3.math.ColorRGBA</span>;
<span class="keyword">import</span> <span class="include">com.jme3.math.Vector3f</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.Geometry</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.Node</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.shape.Box</span>;

<span class="comment">/** Sample 2 - How to use nodes as handles to manipulate objects in the scene.
 * You can rotate, translate, and scale objects by manipulating their parent nodes.
 * The Root Node is special: Only what is attached to the Root Node appears in the scene.
 * 你可以通过变换个体的父节点来变换个体。
 * 根节点（rootNode）是特别的：这有附着在根节点的个体才会被渲染到画布。*/</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloNode</span> <span class="directive">extends</span> SimpleApplication {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args){
        HelloNode app = <span class="keyword">new</span> HelloNode();
        app.start();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> simpleInitApp() {

        <span class="comment">/** create a blue box at coordinates (1,-1,1)
            在坐标（1,-1,1）创建蓝方块*/</span>
        <span class="predefined-type">Box</span> box1 = <span class="keyword">new</span> <span class="predefined-type">Box</span>(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>);
        Geometry blue = <span class="keyword">new</span> Geometry(<span class="string"><span class="delimiter">&quot;</span><span class="content">Box</span><span class="delimiter">&quot;</span></span>, box1);
        blue.setLocalTranslation(<span class="keyword">new</span> Vector3f(<span class="integer">1</span>,-<span class="integer">1</span>,<span class="integer">1</span>));
        Material mat1 = <span class="keyword">new</span> Material(assetManager,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">Common/MatDefs/Misc/Unshaded.j3md</span><span class="delimiter">&quot;</span></span>);
        mat1.setColor(<span class="string"><span class="delimiter">&quot;</span><span class="content">Color</span><span class="delimiter">&quot;</span></span>, ColorRGBA.Blue);
        blue.setMaterial(mat1);

        <span class="comment">/** create a red box straight above the blue one at (1,3,1)
            在坐标（1,3，1）创建红方块*/</span>
        <span class="predefined-type">Box</span> box2 = <span class="keyword">new</span> <span class="predefined-type">Box</span>(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>);
        Geometry red = <span class="keyword">new</span> Geometry(<span class="string"><span class="delimiter">&quot;</span><span class="content">Box</span><span class="delimiter">&quot;</span></span>, box2);
        red.setLocalTranslation(<span class="keyword">new</span> Vector3f(<span class="integer">1</span>,<span class="integer">3</span>,<span class="integer">1</span>));
        Material mat2 = <span class="keyword">new</span> Material(assetManager,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">Common/MatDefs/Misc/Unshaded.j3md</span><span class="delimiter">&quot;</span></span>);
        mat2.setColor(<span class="string"><span class="delimiter">&quot;</span><span class="content">Color</span><span class="delimiter">&quot;</span></span>, ColorRGBA.Red);
        red.setMaterial(mat2);

        <span class="comment">/** Create a pivot node at (0,0,0) and attach it to the root node
            根节点坐标（0,0,0）附着上新的节点*/</span>
        Node pivot = <span class="keyword">new</span> Node(<span class="string"><span class="delimiter">&quot;</span><span class="content">pivot</span><span class="delimiter">&quot;</span></span>);
        rootNode.attachChild(pivot); <span class="comment">// put this node in the scene</span>

        <span class="comment">/** Attach the two boxes to the *pivot* node. (And transitively to the root node.)
            在这个节点附着上方块*/</span>
        pivot.attachChild(blue);
        pivot.attachChild(red);
        <span class="comment">/** Rotate the pivot node: Note that both boxes have rotated!
            选择节点： 注意方块也跟着旋转*/</span>
        pivot.rotate(<span class="float">.4f</span>,<span class="float">.4f</span>,<span class="float">0f</span>);
    }
}</code></pre></div></div>
<div class="paragraph"><p>编译和运行代码。 你应该看到两个方块，而且它们都有一样的旋转方向。</p></div></div></div>
<div class="sect1"><h2 id="理解术语">理解术语</h2><div class="sectionbody"><div class="paragraph"><p>在这里，你会学到新的术语：</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">你想怎么做？</th><th class="tableblock halign-left valign-top">如何用JME3的术语表达？</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>布置场景。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>填充个体到场景。</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>创建场景个体。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>创景空间物体（比如创建几何体）</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>使个体在画布上显示。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>附着空间物体到rootNode。</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>使个体在画布上消失。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>解除物体在rootNode的绑定。</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>移动，选择和缩放</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>移动，选择和缩放 = 变换个体。</p></div></div></td></tr></tbody></table>
<div class="paragraph"><p>所有JME3应用有一个rootNode： 你的游戏从SimpleApplica自动继承了 <code>rootNode</code> 。所有绑定在rootNode的个体是场景的一部分。场景的组成是空间物体。</p></div>
<div class="ulist"><ul><li><p>空间物体包括物体的位移，旋转和大小。</p></li><li><p>空间物体可以读取，变换和保存。</p></li><li><p>有两种空间物体：Nodes（节点）和Geometries（几何体）。</p></li></ul></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 10%;"><col style="width: 45%;"><col style="width: 45%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Geometry（几何体）</th><th class="tableblock halign-left valign-top">Node（节点）</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>可见性：</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>几何体是可见的物体。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>节点是不可见的，负责管理场景个体。</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>目的:</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>几何体包含个体的形状信息。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>节点被几何体和其他节点绑定，从而组成一个群体。</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>示例:</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>方块，球体，玩家，建筑，地形，汽车，导弹，NPCs等</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>根节点，节点包含几个地形，节点包含汽车和乘客，节点包含玩家和武器，音频的节点等</p></div></div></td></tr></tbody></table></div></div>
<div class="sect2"><h3 id="了解代码">了解代码</h3><div class="paragraph"><p>使用 <code>simpleInitApp()</code> 函数来初始化场景，这在第一个教程里有介绍。</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>创建一个方块几何体</p><div class="ulist"><ul><li><p>创建方块形状，运用（1,1,1）的向外延伸。这样会创建一个2x2x2单位长度的方块。</p></li><li><p>使用 setLocalTranslation() 函数把方块放到（1，-1,1）的位置。</p></li><li><p>运用方块形状创建几何体。</p></li><li><p>创建蓝色材质</p></li><li><p>把材质应用到方块几何体上。
.</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">    <span class="predefined-type">Box</span> box1 = <span class="keyword">new</span> <span class="predefined-type">Box</span>(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>);
    Geometry blue = <span class="keyword">new</span> Geometry(<span class="string"><span class="delimiter">&quot;</span><span class="content">Box</span><span class="delimiter">&quot;</span></span>, box1);
    blue.setLocalTranslation(<span class="keyword">new</span> Vector3f(<span class="integer">1</span>,-<span class="integer">1</span>,<span class="integer">1</span>));
    Material mat1 = <span class="keyword">new</span> Material(assetManager,<span class="string"><span class="delimiter">&quot;</span><span class="content">Common/MatDefs/Misc/Unshaded.j3md</span><span class="delimiter">&quot;</span></span>);
    mat1.setColor(<span class="string"><span class="delimiter">&quot;</span><span class="content">Color</span><span class="delimiter">&quot;</span></span>, ColorRGBA.Blue);
    blue.setMaterial(mat1);</code></pre></div></div></li><li><p>创建第二个方块几何体</p><div class="ulist"><ul><li><p>用同样的大小创建第二个方块形状</p></li><li><p>把第二个方块放在（1,3,1），在第一个方块的正上方，2个单位长度的间隔。</p></li><li><p>运用方块形状创建几何体。</p></li><li><p>创建红色材质</p></li><li><p>把材质应用到方块几何体上。</p><div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">    <span class="predefined-type">Box</span> box2 = <span class="keyword">new</span> <span class="predefined-type">Box</span>(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>);
    Geometry red = <span class="keyword">new</span> Geometry(<span class="string"><span class="delimiter">&quot;</span><span class="content">Box</span><span class="delimiter">&quot;</span></span>, box2);
    red.setLocalTranslation(<span class="keyword">new</span> Vector3f(<span class="integer">1</span>,<span class="integer">3</span>,<span class="integer">1</span>));
    Material mat2 = <span class="keyword">new</span> Material(assetManager,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">Common/MatDefs/Misc/Unshaded.j3md</span><span class="delimiter">&quot;</span></span>);
    mat2.setColor(<span class="string"><span class="delimiter">&quot;</span><span class="content">Color</span><span class="delimiter">&quot;</span></span>, ColorRGBA.Red);
    red.setMaterial(mat2);</code></pre></div></div></li></ul></div></li><li><p>创建节点</p><div class="ulist"><ul><li><p>给节点命名 <code>pivot</code> 。</p></li><li><p>节点默认位置在（1,1,1）。</p></li><li><p>把节点绑定的根节点上。</p></li><li><p>节点在场景上是不可见的。</p><div class="openblock"><div class="content"><div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">    Node pivot = <span class="keyword">new</span> Node(<span class="string"><span class="delimiter">&quot;</span><span class="content">pivot</span><span class="delimiter">&quot;</span></span>);
    rootNode.attachChild(pivot);</code></pre></div></div>
<div class="paragraph"><p>如果你的应用只运行到这里，场景是不会有东西显示的。因为节点是不可见的，而且可见的几何体也没有绑定到rootNode上。</p></div></div></div></li></ul></div></li><li><p>绑定两个方块几何体到pivot节点上.</p><div class="openblock"><div class="content"><div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">        pivot.attachChild(blue);
        pivot.attachChild(red);</code></pre></div></div>
<div class="paragraph"><p>如果你的应用只运行到这里，你会看到两个方块：红色的方块在蓝色的上面。</p></div></div></div></li><li><p>旋转pivot节点。</p><div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">        pivot.rotate( <span class="float">0.4f</span> , <span class="float">0.4f</span> , <span class="float">0.0f</span> );</code></pre></div></div></li></ol></div>
<div class="paragraph"><p>如果你的应用只运行到这里，你会看到两个方块都向同一个方向旋转。。</p></div>
<div class="sect2"><h3 id="什么是-pivot-节点">什么是 “Pivot” 节点?</h3><div class="paragraph"><p>你可以相对于“几何体的中心”或者“用户定义的中心”变换（比如，旋转）几何体。这个用户定义的中心就是“Pivor”节点。用户可以用它自定以一个或多个几何体的中心。</p></div>
<div class="paragraph"><p>在这个实例里，有两个几何体绑定在一个“pivot”节点。通过变换“pivot”节点，同时变换两个几何体。旋转“pivot”节点会同时旋转所有被绑定的几何体。“pivot”节点的中心就是旋转的中心。在绑定其他几何体时，先确定“pivot”节点在坐标（0,0,0）。变换父节点会同时变换所有的子节点。你将会经常用到这个方法。</p></div>
<div class="paragraph"><p><strong>例子：</strong> 一辆汽车和它的驾驶员同时移动；一个带有卫星的行星围绕恒星旋转。</p></div>
<div class="paragraph"><p>这个实例里，如果你不创建“pivot”节点而是只变换几何体，那么所有变换都是相对于几何体自己的中心。</p></div>
<div class="paragraph"><p><strong>例子：</strong> 如果旋转每一个方块（用 <code>red.rotate(0.1f , 0.2f , 0.3f);</code> 和 <code>blue.rotate(0.5f , 0.0f , 0.25f);</code>），那么每个方块都会相对于自身的中心旋转。这就像行星的自转。</p></div></div></div>
<div class="sect1"><h2 id="如何布置场景">如何布置场景?</h2><div class="sectionbody"><table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 30%;"><col style="width: 70%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">目标…?</th><th class="tableblock halign-left valign-top">解决方法!</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>创建一个空间体（Spatial）.</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>创建一个网格，把它包装成几何体然后给予它材质。比如：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Box</span> mesh = <span class="keyword">new</span> <span class="predefined-type">Box</span>(Vector3f.ZERO, <span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">1</span>); <span class="comment">// a cuboid default mesh</span>
Geometry thing = <span class="keyword">new</span> Geometry(<span class="string"><span class="delimiter">&quot;</span><span class="content">thing</span><span class="delimiter">&quot;</span></span>, mesh);
Material mat = <span class="keyword">new</span> Material(assetManager,
   <span class="string"><span class="delimiter">&quot;</span><span class="content">Common/MatDefs/Misc/ShowNormals.j3md</span><span class="delimiter">&quot;</span></span>);
thing.setMaterial(mat);</code></pre></div></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>在画布显示物体。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>绑定空间体到 <code>rootNode</code> ，或者任何绑定在 rootNode 的节点。</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">rootNode.attachChild(thing);</code></pre></div></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>从画布移除物体。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>解除空间体在 <code>rootNode</code> 和任何绑定在 rootNode 的节点的绑定。</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">rootNode.detachChild(thing);</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">rootNode.detachAllChildren();</code></pre></div></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>通过个体名字，ID或父子关系找到空间体。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>通过节点的父子找：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">Spatial thing = rootNode.getChild(<span class="string"><span class="delimiter">&quot;</span><span class="content">thing</span><span class="delimiter">&quot;</span></span>);</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">Spatial twentyThird = rootNode.getChild(<span class="integer">22</span>);</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">Spatial parent = myNode.getParent();</code></pre></div></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>决定什么会在初始时加载。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>所有你初始化了同时绑定在 <code>rootNode</code> 的个体将是游戏初始场景的一部分。</p></div></div></td></tr></tbody></table></div></div>
<div class="sect1"><h2 id="如何变换空间体">如何变换空间体</h2><div class="sectionbody"><div class="paragraph"><p>变换有3种： 位移，旋转和缩放</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 55%;"><col style="width: 15%;"><col style="width: 15%;"><col style="width: 15%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">位移来移动空间体</th><th class="tableblock halign-left valign-top">X轴</th><th class="tableblock halign-left valign-top">Y轴</th><th class="tableblock halign-left valign-top">Z轴</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>用3个维度来表示新的位移： 在原点的位移向 右-上-前 3个方向上移动多少来移动到目标位移，比如(0,40.2f,-2）：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">thing.setLocalTranslation( <span class="keyword">new</span> Vector3f( <span class="float">0.0f</span>, <span class="float">40.2f</span>, -<span class="float">2.0f</span> ) );</code></pre></div></div>
<div class="literalblock"><div class="content"><pre>在原来的位移移动一定的量，比如更高(y=40.2f)和更远(z=-2.0f):</pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">thing.move( <span class="float">0.0f</span>, <span class="float">40.2f</span>, -<span class="float">2.0f</span> );</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>+右 -左</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>+上 -下</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>+前 -后</p></div></div></td></tr></tbody></table>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 55%;"><col style="width: 15%;"><col style="width: 15%;"><col style="width: 15%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">缩放来改变空间体大小</th><th class="tableblock halign-left valign-top">x轴</th><th class="tableblock halign-left valign-top">y轴</th><th class="tableblock halign-left valign-top">z轴</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>输入在每个维度的缩放比例：长度，高度，宽度。<br>
0.0f到1.0f的数值把空间体变小；大于1.0f的数值把空间体变大；1.0f不缩放空间体。<br>
用相同的数值缩放会保持空间体的比例，不同数值会相应的拉伸空间体。<br>
比如，把空间体变成，10倍于原来的长度，0.1倍于原来的高度，保持高度不变：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">thing.scale( <span class="float">10.0f</span>, <span class="float">0.1f</span>, <span class="float">1.0f</span> );</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>长度</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>高度</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>宽度</p></div></div></td></tr></tbody></table>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 55%;"><col style="width: 15%;"><col style="width: 15%;"><col style="width: 15%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">旋转来转动空间体</th><th class="tableblock halign-left valign-top">X轴 俯仰角(Pitch)</th><th class="tableblock halign-left valign-top">Y轴 偏航角(Yaw)</th><th class="tableblock halign-left valign-top">Z轴 旋转角(Roll)</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>3D旋转可能会有点复杂 (<a href="../jme3/rotate.html">详情请看这里</a>)。简单来说：你可以绕3个轴旋转：俯仰角，偏航角和旋转角。你可以输入弧度或用角度乘以 <code>FastMath.DEG_TO_RAD</code> 。<br>
比如，旋转物体的Z轴180度：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">thing.rotate( <span class="float">0f</span> , <span class="float">0f</span> , <span class="integer">180</span>*FastMath.DEG_TO_RAD );</code></pre></div></div>
<div class="paragraph"><p>小贴士：如果你的游戏运用到大量旋转，很值得查看 <a href="../jme3/quaternion.html">四元数(quaternions)</a>，一个数据结构可以效率的运算和保存。</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">thing.setLocalRotation(
  <span class="keyword">new</span> Quaternion().fromAngleAxis(<span class="integer">180</span>*FastMath.DEG_TO_RAD, <span class="keyword">new</span> Vector3f(<span class="integer">1</span>,<span class="integer">0</span>,<span class="integer">0</span>)));</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>点头</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>摇头</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>左右摆动头</p></div></div></td></tr></tbody></table></div></div>
<div class="sect1"><h2 id="我应该如何故障排除空间体">我应该如何故障排除空间体？</h2><div class="sectionbody"><div class="paragraph"><p>如果你得到意料之外的结果，可以根据以下检查你的通常错误：</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 40%;"><col style="width: 60%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">问题?</th><th class="tableblock halign-left valign-top">解决方案!</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>创建的几何体没能在场景中显示。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>是否有把这个几何体绑定到rootNode？<br>
它有材质吗？<br>
它的变换是什么（位置）？<br>
它是在相机的后面还是被其他几何体挡住了？<br>
它是否太小或太大了？<br>
它是否离相机太远了？ (尝试 <a href="http://javadoc.jmonkeyengine.org/com/jme3/renderer/Camera.html#setFrustumFar(float)">cam.setFrustumFar</a>(111111f); 来看得更远)<br></p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>空间体的旋转不是所想要的。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>用的是角度还是弧度？（如果用的是角度，用 FastMath.DEG_TO_RAD 乘以它们来得到弧度）<br>
是否在移动它之前创建空间体到原点 (Vector.ZERO) ?<br>
是否根据正确的枢轴（pivot）节点旋转还是别的节点？<br>
是否在正确的轴旋转？</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>几何体的颜色或材质不是所想的。</p></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>你是否重用了其他几何体的材质和不经意地改动了它的属性？(是的话，考虑复制它: mat2 = mat.clone(); )</p></div></div></td></tr></tbody></table></div></div>
<div class="sect1"><h2 id="如何添加自定义数据到空间体">如何添加自定义数据到空间体？</h2><div class="sectionbody"><div class="paragraph"><p>很多空间体代表游戏的角色和其他互动的个体。比如，上面围绕共同枢轴旋转两个立方体的代码可以用在连接在轨道空间站的宇宙飞船。</p></div>
<div class="paragraph"><p>根据你的游戏，游戏个体不仅位移，选装和缩放（你刚学到的“变换”）。游戏个体还有自定义的属性，比如生命值，携带物品，装备，或船体强度和空间站的所剩燃油。在Java，你用类的变量来代表对象， 比如，floats，Strings，和Arrays。</p></div>
<div class="paragraph"><p>你可以直接添加自定义数据到节点和几何体。 <strong>你不需要extends节点的类（Node）来包含变量</strong>！
比如，给节点添加自定义id，你可以这样做：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java">pivot.setUserData( <span class="string"><span class="delimiter">&quot;</span><span class="content">pivot id</span><span class="delimiter">&quot;</span></span>, <span class="integer">42</span> );</code></pre></div></div>
<div class="paragraph"><p>要在别处读取节点的id，你可以这样做：</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> id = pivot.getUserData( <span class="string"><span class="delimiter">&quot;</span><span class="content">pivot id</span><span class="delimiter">&quot;</span></span> );</code></pre></div></div>
<div class="paragraph"><p>通过使用不同的Strings映射（keys）（这里的映射是 <code>pivot id</code>）,你可以get和set任何空间体需要携带的数据。当你开始写你的游戏时，你可能添加燃油数值到汽车节点，速度数值到飞机节点，或金币数到玩家节点，等等。但是，需要注意的是只有implements了Savable类的自定义个体可以这样做。</p></div></div></div>
<div class="sect1"><h2 id="结语">结语</h2><div class="sectionbody"><div class="paragraph"><p>你学到了3d场景是一个带有空间体的场景图：可视的几何体和不可视的节点。你可以变换空间体，或者绑定它们到节点然后变换节点。你学会了最方便的方法来添加自定义个体数据（比如玩家生命和汽车速度）到几何体。</p></div>
<div class="paragraph"><p>因为标准形状比如球体和立方体不经常用，在下一个章节你可以学到
<a href="../jme3/beginner/hello_asset.html">导入3d模型等资源</a>.</p></div></div></div></div><div id="footer"><div id="footer-text">Version <br>Last updated 2018-10-03 07:43:05 +00:00</div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script>docsearch({
  apiKey: 'a736b6d93de805e26ec2f49b55013fbd',
  indexName: 'jmonkeyengine',
  inputSelector: '#doc-search',
  debug: false // Set debug to true if you want to inspect the dropdown
});</script></body></html>